<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=BIZ+UDMincho&family=BIZ+UDPGothic&family=IBM+Plex+Sans+JP&family=Space+Grotesk:wght@300..700&display=swap"
        rel="stylesheet">
</head>
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    .biz-udmincho-regular {
        font-family: "BIZ UDMincho", serif;
        font-weight: 400;
        font-style: normal;
    }

    @font-face {
        font-family: 'SUIT';
        src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_suit@1.0/SUIT-Thin.woff2') format('woff2');
        font-weight: 100;
        font-style: normal;
    }

    @font-face {
        font-family: 'SUIT';
        src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_suit@1.0/SUIT-ExtraLight.woff2') format('woff2');
        font-weight: 200;
        font-style: normal;
    }

    @font-face {
        font-family: 'SUIT';
        src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_suit@1.0/SUIT-Light.woff2') format('woff2');
        font-weight: 300;
        font-style: normal;
    }

    @font-face {
        font-family: 'SUIT';
        src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_suit@1.0/SUIT-Regular.woff2') format('woff2');
        font-weight: 400;
        font-style: normal;
    }

    @font-face {
        font-family: 'SUIT';
        src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_suit@1.0/SUIT-Medium.woff2') format('woff2');
        font-weight: 500;
        font-style: normal;
    }

    @font-face {
        font-family: 'SUIT';
        src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_suit@1.0/SUIT-SemiBold.woff2') format('woff2');
        font-weight: 600;
        font-style: normal;
    }

    @font-face {
        font-family: 'SUIT';
        src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_suit@1.0/SUIT-Bold.woff2') format('woff2');
        font-weight: 700;
        font-style: normal;
    }

    @font-face {
        font-family: 'SUIT';
        src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_suit@1.0/SUIT-ExtraBold.woff2') format('woff2');
        font-weight: 800;
        font-style: normal;
    }

    @font-face {
        font-family: 'SUIT';
        src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_suit@1.0/SUIT-Heavy.woff2') format('woff2');
        font-weight: 900;
        font-style: normal;
    }

    .space-grotesk {
        font-family: "Space Grotesk", sans-serif;
        font-optical-sizing: auto;
        font-weight: 400;
        font-style: normal;
    }

    body,
    html {
        width: 100vw;
        height: auto;
        margin: 0;
        padding: 0;
        background-color: #DBD3C8;
        background-image: url('./img/·Ñå·Ö©·Üº·Ñã·Öµ·Ñå·Öµ·ÜØ·ÑÄ·Ö°·Ü∑.png');
        background-size: cover;
        /* border: 1px solid red; */
        overflow-x: hidden;
    }

    header {
        position: fixed;
        top: 0;
        left: 0;
        display: flex;
        /* border: 1px solid red; */
        justify-content: center;
        align-items: center;
        padding: 1.5vw;
        z-index: 30;
        /* border: 1px solid red; */
        width: 100vw;
        transition: all 0.5s ease;
        border-radius: 0 0 1.1vw 1.1vw;
    }

    header .logo-name {
        /* width: 4.5vw; */
        font-size: 1.5vw;
        position: relative;
        right: 42vw;
        font-family: "BIZ UDMincho", serif;
        font-weight: 300;
    }

    header ul {
        display: flex;
        list-style-type: none;
        /* border: 1px solid red; */
        position: absolute;
        left: 72vw;
    }

    header ul li {
        padding: 1.5vw;
    }

    header a {
        text-decoration: none;
        color: #FFFFFF;
        font-family: 'SUIT';
        transition: all 0.5s ease;
        font-size: 0.9vw;
    }

    header.scroll {
        background-color: rgba(255, 255, 255, 0.151);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        transition: background-color 0.5s ease, backdrop-filter 0.5s ease;
    }


    header.scroll li a,
    header.scroll .logo-name {
        color: #F7F8F8;
    }

    #package-content {
        width: 100vw;
        min-height: 50vw;
        /* border: 3px solid red; */
        display: flex;
        flex-flow: column;
        justify-content: center;
        align-items: center;
        background-image: url('img/value-bg.png');
        background-size: cover;
        background-repeat: no-repeat;
        padding-top: 4vw;
    }

    #package-content h2 {
        font-family: 'SUIT';
        font-weight: 400;
        font-size: 2vw;
    }

    .package {
        position: relative;
        width: 50vw;
        height: 50vw;
        padding: 16px;
        border-radius: 8px;
        overflow: visible;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
    }

    .text-line {
        position: absolute;
        cursor: grab;
        font-size: 16px;
        user-select: none;
        background: transparent;
        transition: font-size 0.2s ease;
    }


    /* Í∏∞Ï°¥ ÏÑ†ÌÉùÎêú Î¨∏Ïû• Î∞∞Í≤ΩÏÉâ Ïä§ÌÉÄÏùº ÏÇ≠Ï†ú ÎòêÎäî ÏàòÏ†ï */
    .text-line.selected {
        outline: 0.08vw solid #c8c8c8;
        background-color: #fff;
        /* Ìù∞ÏÉâ Î∞∞Í≤Ω Ï†ÅÏö© */
        /* background: transparent;  ‚Üê Ïù¥ Ï§Ñ ÏßÄÏö∞Í±∞ÎÇò Ï£ºÏÑù Ï≤òÎ¶¨ */
        outline-offset: 0.2vw;
        padding: 0;
        border-radius: 0.1vw;
        transition: outline-color 0.2s ease, box-shadow 0.2s ease;
    }


    .controls {
        display: flex;
        /* flex-direction: column; */
        justify-content: center;
        align-items: center;
        gap: 1rem;
        /* align-items: center; */
    }

    .controls label {
        font-size: 14px;
    }

    /* input[type="color"],
    input[type="number"] {
        padding: 4px;
        font-size: 14px;
        margin-left: 8px;
    } */

    /* .hint {
        font-size: 12px;
        color: #999;
        margin-top: 1rem;
    } */

    /* .trash {
        width: 60px;
        height: 60px;
        margin-top: 2rem;
        background: #ccc;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        color: #fff;
    } */

    /* .undo-btn {
        margin-top: 1rem;
        font-size: 14px;
        padding: 6px 14px;
        border: 1px solid #aaa;
        background: white;
        cursor: pointer;
        border-radius: 4px;
    } */

    /* .undo-btn:hover {
        background: #eee;
    } */
</style>

<body>
    <header>
        <a class="logo-name" href="index.html">
            <p>ÂéüÁ°èÂìâ</p>
        </a>
        <ul>
            <li><a href="index.html#hara">ABOUT</a></li>
            <li><a href="nav.html">DESIGN</a></li>
            <li><a href="value.html">EMPTINESS</a></li>
        </ul>
    </header>

    <section id="package-content">
        <!-- <h2>Begin Your Own Emptiness</h2> -->

        <!-- <div class="package" id="package" style="background-image: url('../img/·Ñë·Ö¢·Ñè·Öµ·Ñå·Öµ.png');
                        background-size: cover;
                        background-position: center;
                        width: 300px;
                        height: 420px;
                        padding: 16px;
                        border-radius: 8px;"> -->


        <div class="package" id="package" style="background-image: url('../img/Ìå®ÌÇ§ÏßÄ.png');">
            <div class=" text-line" draggable="true" style="top: 6vw; left: 3vw;">MUJI‚Ñ¢</div>
            <div class="text-line" draggable="true" style="top: 8vw; left: 3vw;">Pure Essence Face Mist</div>
            <div class="text-line" draggable="true" style="top: 11vw; left: 3vw; font-size:14px;">
                Refreshing hydration for your sensitive skin.
            </div>
            <div class="text-line" draggable="true" style="top: 13vw; left: 3vw;">120ml / Made in Japan</div>
            <div class="text-line" draggable="true" style="top: 15vw; left: 3vw; font-size:13px;">
                Ï£ºÏöî ÏÑ±Î∂Ñ: Water (Aqua), Aloe Vera Extract, Chamomile Extract, Glycerin
            </div>
            <div class="text-line" draggable="true" style="top: 19vw; left: 3vw; font-size:12px;">
                ÏÇ¨Ïö©Î≤ï: ÏñºÍµ¥ÏóêÏÑú 20cm Îñ®Ïñ¥Ï†∏ Í≥†Î•¥Í≤å Î∂ÑÏÇ¨Ìï¥ Ï£ºÏÑ∏Ïöî. ÏïÑÏπ®, Ï†ÄÎÖÅ ÏÇ¨Ïö© Í∂åÏû•.
            </div>
            <div class="text-line" draggable="true" style="top: 21vw; left: 3vw; font-size:12px; color:#555;">
                Ï£ºÏùò ÏÇ¨Ìï≠: ÏßÅÏÇ¨Í¥ëÏÑ†ÏùÑ ÌîºÌï¥ ÏÑúÎäòÌïú Í≥≥Ïóê Î≥¥Í¥ÄÌïòÏÑ∏Ïöî.<br>
                ÏÇ¨Ïö© Ï§ë ÌîºÎ∂Ä Ïù¥ÏÉÅ Ïãú ÏÇ¨Ïö©ÏùÑ Ï§ëÎã®ÌïòÏÑ∏Ïöî.
            </div>
            <div class="text-line" draggable="true" style="top: 25vw; left: 3vw; font-size:11px; color:#777;">
                Ï†úÏ°∞ÏÇ¨: Manufactured by MUJI Co., Ltd.<br>
                Í≥†Í∞ùÏÑºÌÑ∞: 1234-5678
            </div>
            <div class="text-line" draggable="true" style="top: 29vw; left: 3vw; font-size:11px; color:#999;">
                Î∞îÏΩîÎìú: 1234 5678 9012
            </div>
        </div>

        <!-- </div> -->



        <div class="controls">
            <div>
                <!-- <label>üé® Î∞∞Í≤Ω ÏÉâ:</label> -->
                <!-- <input type="color" id="bgColorPicker" value="#eeeeee" /> -->
            </div>

            <div>
                <label>Font size</label>
                <input type="number" id="fontSizeInput" value="16" min="8" max="40" />
            </div>

            <div class="trash" id="trash">üóëÔ∏è</div>
            <button class="undo-btn" onclick="undoDelete()">ÎêòÎèåÎ¶¨Í∏∞</button>

            <button id="saveBtn">üíæ Ìå®ÌÇ§ÏßÄ Ïù¥ÎØ∏ÏßÄ Ï†ÄÏû•ÌïòÍ∏∞</button>
        </div>

        <!-- <div class="trash" id="trash">üóëÔ∏è</div>
        <button class="undo-btn" onclick="undoDelete()">ÎêòÎèåÎ¶¨Í∏∞</button> -->

        <!-- <div class="hint">üí° Î¨∏Ïû•ÏùÑ ÌÅ¥Î¶≠ÌïòÏó¨ ÏÑ†ÌÉù ÌõÑ Í∞úÎ≥Ñ Ïä§ÌÉÄÏùº Ï°∞Ï†ï / ÎìúÎûòÍ∑∏Ìï¥ÏÑú Ïì∞Î†àÍ∏∞ÌÜµÏóê Î≤ÑÎ¶¥ Ïàò ÏûàÏñ¥Ïöî</div> -->

        <!-- <button id="saveBtn">üíæ Ìå®ÌÇ§ÏßÄ Ïù¥ÎØ∏ÏßÄ Ï†ÄÏû•ÌïòÍ∏∞</button> -->

        <h1>Begin Your Own Emptiness</h1>
        <p>‚ÄúBegin Your Own Emptiness‚Äù is an interactive experience where you can explore Kenya Hara‚Äôs design philosophy
            firsthand.
            Clear away the unnecessary and create your own simple, essential product packaging. Discover a unique
            journey of finding
            true value within simplicity.</p>

    </section>


    <!-- <section id="end">
        <h3>
            "Emptiness is not the absence of everything, <br>
            but the presence of only the essential."
        </h3>

        <h1>
            "What sense of emptiness did you leave behind?"
        </h1>
    </section> -->
    <script>
        const packageBox = document.getElementById("package");
        const bgColorPicker = document.getElementById("bgColorPicker");
        const fontSizeInput = document.getElementById("fontSizeInput");
        const trash = document.getElementById("trash");
        const undoBtn = document.querySelector(".undo-btn");

        let selected = null;
        let deletedStack = [];
        let historyStack = [];  // ÏÉÅÌÉú Ï†ÄÏû• Ïä§ÌÉù

        // ÏÉÅÌÉú Ï†ÄÏû• Ìï®Ïàò (Î™®Îì† text-line ÏÉÅÌÉúÎ•º Í∏∞Î°ù)
        function saveState() {
            const lines = Array.from(packageBox.querySelectorAll('.text-line')).map(el => ({
                content: el.innerText,
                fontSize: el.style.fontSize || "16px",
                top: el.style.top,
                left: el.style.left,
                color: el.style.color || "black",
                id: el.dataset.id  // idÍ∞Ä ÏóÜÏúºÎ©¥ ÎÇòÏ§ëÏóê Î∂ÄÏó¨Ìï† ÏàòÎèÑ ÏûàÏùå
            }));
            historyStack.push(lines);
            // ÏÉÅÌÉú Ïä§ÌÉù ÎÑàÎ¨¥ Ïª§ÏßÄÏßÄ ÏïäÍ≤å ÏµúÎåÄ ÌÅ¨Í∏∞ Ï†úÌïú Í∞ÄÎä•
        }

        // ÏÉÅÌÉú Î≥µÏõê Ìï®Ïàò
        function restoreState(state) {
            // ÏÉÅÌÉúÍ∞Ä Î∞∞Ïó¥ÏûÑ (Í∞Å Î¨∏Ïû• Ï†ïÎ≥¥)
            packageBox.innerHTML = '';
            state.forEach(line => {
                const newLine = document.createElement("div");
                newLine.className = "text-line";
                newLine.innerText = line.content;
                newLine.style.fontSize = line.fontSize;
                newLine.style.top = line.top;
                newLine.style.left = line.left;
                newLine.style.color = line.color;
                newLine.setAttribute("draggable", "false"); // draggableÏùÄ falseÎ°ú Î∞îÍøà (ÎßàÏö∞Ïä§ Ïù¥ÎèôÏúºÎ°ú Ï≤òÎ¶¨)
                packageBox.appendChild(newLine);
                attachDragHandlers(newLine); // ÎìúÎûòÍ∑∏ Ïù¥Î≤§Ìä∏ ÏÉàÎ°ú Î∂ôÏûÑ
            });
        }

        // Í∏∞Ï°¥ Ìå®ÌÇ§ÏßÄ Î∞ïÏä§ ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏ (Î¨∏Ïû• ÏÑ†ÌÉù Ï≤òÎ¶¨)
        packageBox.addEventListener("click", (e) => {
            if (e.target.classList.contains("text-line")) {
                if (selected) selected.classList.remove("selected");
                selected = e.target;
                selected.classList.add("selected");
                fontSizeInput.value = parseInt(window.getComputedStyle(selected).fontSize);
            }
        });

        // Ìå®ÌÇ§ÏßÄ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú ÏÑ†ÌÉù Ìï¥Ï†ú Ï≤òÎ¶¨
        document.addEventListener("click", (e) => {
            const target = e.target;
            // ÏòàÏô∏ Ï≤òÎ¶¨ ÎåÄÏÉÅ ÏöîÏÜåÎì§
            const isTextLine = target.classList.contains("text-line");
            const isInPackage = packageBox.contains(target);
            const isInControls = document.querySelector('.controls').contains(target);

            if (!isTextLine && !isInPackage && !isInControls) {
                if (selected) {
                    selected.classList.remove("selected");
                    selected = null;
                    fontSizeInput.value = 16; // ÌïÑÏöîÏãú Í∏∞Î≥∏Í∞í Ï¥àÍ∏∞Ìôî
                }
            }
        });



        // Ìè∞Ìä∏ ÌÅ¨Í∏∞ Ï°∞Ï†à
        fontSizeInput.addEventListener("input", (e) => {
            if (selected) {
                saveState();
                selected.style.fontSize = `${e.target.value}px`;
            }
        });

        // Î∞∞Í≤Ω ÏÉâ Î≥ÄÍ≤Ω
        // bgColorPicker.addEventListener("input", (e) => {
        //     saveState();
        //     packageBox.style.backgroundColor = e.target.value;
        // });

        // ÎìúÎûòÍ∑∏ ÏÇ≠Ï†ú
        let dragged = null;
        packageBox.addEventListener("dragstart", (e) => {
            if (e.target.classList.contains("text-line")) {
                dragged = e.target;
            }
        });

        trash.addEventListener("dragover", (e) => {
            e.preventDefault();
            trash.style.background = "#aa3333";
        });

        trash.addEventListener("dragleave", () => {
            trash.style.background = "#ccc";
        });

        trash.addEventListener("drop", () => {
            if (dragged) {
                saveState();
                deletedStack.push({
                    content: dragged.innerText,
                    fontSize: dragged.style.fontSize || "16px",
                    top: dragged.style.top,
                    left: dragged.style.left,
                    color: dragged.style.color || "black"
                });
                dragged.remove();
                trash.style.background = "#ccc";
                dragged = null;
            }
        });

        // ÎêòÎèåÎ¶¨Í∏∞ (Undo)
        function undoDelete() {
            if (historyStack.length === 0) return;
            const prevState = historyStack.pop();
            restoreState(prevState);
            selected = null;
            fontSizeInput.value = 16;
        }

        // ÏÉà Î¨∏Ïû•Ïóê ÎìúÎûòÍ∑∏ Ìï∏Îì§Îü¨ Î∂ôÏù¥Îäî Ìï®Ïàò
        function attachDragHandlers(el) {
            let offsetX, offsetY;
            el.style.position = 'absolute';
            el.style.cursor = 'grab';

            el.addEventListener('mousedown', (e) => {
                e.preventDefault();
                offsetX = e.clientX - el.getBoundingClientRect().left;
                offsetY = e.clientY - el.getBoundingClientRect().top;
                el.style.zIndex = 1000;

                function onMouseMove(e) {
                    el.style.left = `${e.clientX - packageBox.getBoundingClientRect().left - offsetX}px`;
                    el.style.top = `${e.clientY - packageBox.getBoundingClientRect().top - offsetY}px`;
                }

                function onMouseUp(e) {
                    document.removeEventListener('mousemove', onMouseMove);
                    document.removeEventListener('mouseup', onMouseUp);
                    el.style.zIndex = 1;

                    // ÎßàÏö∞Ïä§ ÏúÑÏπòÍ∞Ä trash ÏïàÏù∏ÏßÄ Ï≤¥ÌÅ¨
                    const trashRect = trash.getBoundingClientRect();
                    if (
                        e.clientX >= trashRect.left &&
                        e.clientX <= trashRect.right &&
                        e.clientY >= trashRect.top &&
                        e.clientY <= trashRect.bottom
                    ) {
                        // ÏÇ≠Ï†ú Ï≤òÎ¶¨
                        saveState();
                        deletedStack.push({
                            content: el.innerText,
                            fontSize: el.style.fontSize || "16px",
                            top: el.style.top,
                            left: el.style.left,
                            color: el.style.color || "black"
                        });
                        el.remove();
                    } else {
                        // Í∑∏ÎÉ• ÏúÑÏπòÎßå Î≥ÄÍ≤ΩÎêú Í±∞ Ï†ÄÏû•
                        saveState();
                    }
                }

                document.addEventListener('mousemove', onMouseMove);
                document.addEventListener('mouseup', onMouseUp);
            });
        }


        // Ï¥àÍ∏∞ Î¨∏Ïû•Îì§Ïóê ÎìúÎûòÍ∑∏ Ìï∏Îì§Îü¨ Î∂ôÏù¥Í∏∞
        document.querySelectorAll('.text-line').forEach(el => {
            el.style.position = 'absolute'; // Íº≠ ÏúÑÏπò ÏßÄÏ†ï ÌïÑÏöî
            attachDragHandlers(el);
        });

        // Ï¥àÍ∏∞ ÏÉÅÌÉú Ï†ÄÏû•
        saveState();


        const saveBtn = document.getElementById('saveBtn');

        saveBtn.addEventListener('click', () => {
            // Ìå®ÌÇ§ÏßÄ ÏòÅÏó≠ÏùÑ Ï∫°Ï≤ò
            html2canvas(packageBox).then(canvas => {
                // Ï∫îÎ≤ÑÏä§Î•º Ïù¥ÎØ∏ÏßÄ Îç∞Ïù¥ÌÑ∞ URLÎ°ú Î≥ÄÌôò
                const dataURL = canvas.toDataURL('image/png');

                // Îã§Ïö¥Î°úÎìú ÎßÅÌÅ¨ ÏÉùÏÑ±
                const link = document.createElement('a');
                link.href = dataURL;
                link.download = 'my-muji-package.png';

                // Í∞ïÏ†úÎ°ú ÌÅ¥Î¶≠Ìï¥ÏÑú Îã§Ïö¥Î°úÎìú ÏãúÏûë
                link.click();
            });
        });


    </script>
</body>

</html>